<!-- src/main/resources/templates/address/new.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8" />
    <title th:text="${username} + ' 주소 등록'">주소 등록</title>
    <style>
        body { font-family: system-ui, sans-serif; margin: 24px; }
        form { max-width: 560px; display: grid; gap: 14px; }
        label { font-weight: 600; }
        input { width: 100%; padding: 10px; border:1px solid #e5e7eb; border-radius:8px; }
        .row { display:flex; gap:8px; align-items:center; }
        .btn { display:inline-block; padding:10px 14px; border:1px solid #e5e7eb; background:#fff; border-radius:8px; text-decoration:none; cursor:pointer; }
        .btn.primary { background:#111827; color:#fff; border-color:#111827; }
        .toolbar { display:flex; gap:8px; margin-top: 10px; }
    </style>
</head>
<body>
<h1 th:text="${username} + ' 주소 등록'">주소 등록</h1>

<!-- action은 컨트롤러의 @PostMapping("/members/{username}/address") -->
<form th:action="@{/members/{u}/address(u=${username})}" method="post">
    <!-- (Spring Security 사용 시 CSRF 토큰 필요)
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    -->

    <div>
        <label for="label">별칭</label>
        <input id="label" name="label" type="text" placeholder="집 / 회사 / 본가 등" required />
    </div>

    <div>
        <label for="roadNameAddress">도로명 주소</label>
        <div class="row">
            <input id="roadNameAddress" name="roadNameAddress" type="text" placeholder="도로명 주소" readonly required />
            <button class="btn" type="button" onclick="openDaumPostcode()">주소 찾기</button>
        </div>
    </div>

    <div>
        <label for="zipCode">우편번호</label>
        <input id="zipCode" name="zipCode" type="text" placeholder="우편번호" readonly required />
    </div>

    <div class="toolbar">
        <button class="btn" type="button"
                th:onclick="|location.href='@{/members/{u}/address(u=${username})}'|">목록으로</button>
        <button class="btn primary" type="submit">등록</button>
    </div>
</form>

<!-- Daum(카카오) 우편번호 스크립트 -->
<script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    function openDaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                document.getElementById('roadNameAddress').value = data.roadAddress || data.jibunAddress || '';
                document.getElementById('zipCode').value = data.zonecode || '';
            }
        }).open();
    }
</script>
</body>
</html>
