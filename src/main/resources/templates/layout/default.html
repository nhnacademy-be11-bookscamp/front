<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="북스캠프 도서 쇼핑몰">
    <meta name="keywords" content="books, 도서, 쇼핑">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>북스캠프 | BooksCAMP</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <link rel="icon" href="/img/favicon.ico" type="img/x-icon">
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">

    <!-- CSS 스타일 (CDN) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/slicknav.min.css" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/style.css}" type="text/css">

    <!-- 페이지별 추가 CSS -->
    <th:block layout:fragment="extra-css"></th:block>
</head>
<body>
    <!-- 페이지 로더 -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- 모바일 햄버거 메뉴 -->
    <th:block th:replace="~{fragment/header :: humberger}"></th:block>

    <!-- 헤더 -->
    <th:block th:replace="~{fragment/header :: header}"></th:block>

    <!-- Hero 섹션 (카테고리 사이드바 + 검색 + 배너) -->
    <section class="hero" layout:fragment="hero">
        <div class="container">
            <div class="row">
                <!-- 카테고리 사이드바 (동적 데이터: categories, 재귀 구조 지원) -->
                <div class="col-lg-3">
                    <div class="hero__categories">
                        <div class="hero__categories__all">
                            <i class="fa fa-bars"></i>
                            <span>전체 카테고리</span>
                        </div>
                        <ul th:if="${categories != null}" th:replace="~{fragment/category :: categoryList(${categories})}">
                            <li><a href="#">카테고리명</a></li>
                        </ul>
                        <ul th:unless="${categories != null}">
                            <li><a href="#">카테고리를 불러오는 중...</a></li>
                        </ul>
                    </div>
                </div>
                <!-- 검색 영역 + 배너 -->
                <div class="col-lg-9">
                    <!-- 검색창 -->
                    <div class="hero__search">
                        <div class="hero__search__form">
                            <form th:action="@{'/books'}" method="get">
                                <input type="text" name="keyWord" placeholder="찾으시는 도서가 있나요?"
                                       th:value="${keyWord}">
                                <button type="submit" class="site-btn">검색</button>
                            </form>
                        </div>
                        <div class="hero__search__phone">
                            <div class="hero__search__phone__icon">
                                <i class="fa fa-phone"></i>
                            </div>
                            <div class="hero__search__phone__text">
                                <h5>간단질문환영</h5>
                                <span>이용택TA 24시간</span>
                            </div>
                        </div>
                    </div>
                    <!-- 배너 -->
                    <div class="hero__item set-bg" data-setbg="/img/hero/banner.png">
                        <div class="hero__text">
                            <span>BOOKS FRESH</span>
                            <h2>신간 도서<br />특별 할인</h2>
                            <p>지금 바로 최신 도서를 만나보세요</p>
                            <a href="/books" class="primary-btn">쇼핑하기</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Hero 섹션 끝 -->

    <!-- 메인 콘텐츠 영역 -->
    <div layout:fragment="content">
        <h2>콘텐츠 영역</h2>
        <p>이 영역에 페이지별 콘텐츠를 작성하세요.</p>
    </div>

    <!-- 푸터 -->
    <th:block th:replace="~{fragment/footer :: footer}"></th:block>

    <!-- JavaScript 플러그인 (CDN) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/jquery.slicknav.min.js" crossorigin="anonymous"></script>
    <script th:src="@{/js/main.js}"></script>

    <!-- 카테고리 토글 스크립트 -->
    <script>
        $(document).ready(function() {
            // 카테고리 토글 버튼 클릭 이벤트 (관리자 토글 제외)
            $('.category-toggle:not(.admin-toggle)').on('click', function(e) {
                e.preventDefault();
                e.stopPropagation();

                var $toggle = $(this);
                var categoryId = $toggle.data('category-id');
                var $childrenContainer = $('#category-' + categoryId);

                // 토글 버튼 active 클래스 추가/제거 (아이콘 회전)
                $toggle.toggleClass('active');

                // 하위 카테고리 슬라이드 토글 (부드러운 애니메이션)
                $childrenContainer.slideToggle(300, function() {
                    // 애니메이션 완료 후 콜백
                    if ($childrenContainer.is(':visible')) {
                        $toggle.attr('aria-expanded', 'true');
                    } else {
                        $toggle.attr('aria-expanded', 'false');
                    }
                });
            });

            // 카테고리 링크 hover 효과
            $('.category-link').hover(
                function() {
                    $(this).parent('.category-content').addClass('hover');
                },
                function() {
                    $(this).parent('.category-content').removeClass('hover');
                }
            );

            // 접근성 향상: 키보드 네비게이션 지원
            $('.category-toggle').on('keypress', function(e) {
                if (e.which === 13 || e.which === 32) { // Enter 또는 Space
                    e.preventDefault();
                    $(this).click();
                }
            });

            // 초기화: aria 속성 설정
            $('.category-toggle').attr('role', 'button');
            $('.category-toggle').attr('aria-expanded', 'false');
            $('.category-toggle').attr('tabindex', '0');
        });
    </script>

    <!-- 페이지별 추가 JavaScript -->
    <th:block layout:fragment="extra-js"></th:block>
</body>
</html>
