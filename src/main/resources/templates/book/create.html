<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <title>도서 등록</title>

    <!-- 페이지 전용 스타일 -->
    <th:block layout:fragment="extra-css">
        <link rel="stylesheet" th:href="@{/css/book.css}">
        <style>
            .register-form {
                display: grid;
                grid-template-columns: 1fr 2fr;
                gap: 10px 20px;
                max-width: 700px;
                background: #fff;
                padding: 30px;
                border-radius: 12px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            label {
                text-align: right;
                padding-top: 6px;
                font-weight: 600;
                color: #333;
            }
            input, textarea {
                padding: 8px;
                border: 1px solid #ccc;
                border-radius: 6px;
                font-family: inherit;
            }
            button {
                grid-column: span 2;
                padding: 10px;
                border: none;
                border-radius: 6px;
                background: #4A90E2;
                color: white;
                cursor: pointer;
                font-size: 1rem;
                font-weight: 600;
                transition: background 0.2s;
            }
            button:hover {
                background: #357ABD;
            }
            h1 {
                margin-bottom: 20px;
                color: #333;
                font-size: 1.5rem;
                text-align: center;
            }
        </style>
    </th:block>
</head>

<body>
<div layout:fragment="content">
    <h1>📖 도서 등록</h1>

    <form th:action="@{/admin/books/create}" method="post" class="register-form">
        <label>제목</label>
        <input type="text" name="title" th:value="${book.title ?: ''}" required>

        <label>저자</label>
        <input type="text" name="contributors" th:value="${book.author ?: ''}" required>

        <label>출판사</label>
        <input type="text" name="publisher" th:value="${book.publisher ?: ''}" required>

        <label>출판일</label>
        <input type="text" name="publishDate" th:value="${book.publishDate ?: ''}">

        <label>ISBN</label>
        <input type="text" name="isbn" th:value="${book.isbn13 ?: ''}">

        <label>정가</label>
        <input type="number" name="regularPrice" th:value="${book.regularPrice ?: ''}">

        <label>판매가</label>
        <input type="number" name="salePrice" th:value="${book.salePrice ?: ''}">

        <label>목차</label>
        <textarea name="content" rows="3" th:text="${book.content ?: ''}"></textarea>

        <label>설명</label>
        <textarea name="explanation" rows="3" th:text="${book.explanation ?: ''}"></textarea>

       <!-- <label>이미지 URL</label>
        <input type="text" name="imageUrls" th:value="${book.cover ?: ''}" placeholder="쉼표로 구분 가능">

        <label>카테고리</label>
        <input type="text" name="categoryIds" placeholder="1,2,3">

        <label>태그</label>
        <input type="text" name="tagNames" placeholder="태그1,태그2">
-->
        <button type="submit">등록</button>
    </form>
</div>
</body>
<script>
    function submitBook() {
        const form = document.getElementById('registerForm');
        const data = Object.fromEntries(new FormData(form).entries());

        data.imageUrls = data.imageUrls ? data.imageUrls.split(',').map(s => s.trim()) : [];
        data.categoryIds = data.categoryIds ? data.categoryIds.split(',').map(s => Number(s.trim())) : [];
        data.tagNames = data.tagNames ? data.tagNames.split(',').map(s => s.trim()) : [];

        fetch('/admin/books/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
            .then(resp => {
                if (!resp.ok) throw new Error('등록 실패');
                alert('도서 등록 완료!');
                window.location.href = '/books/list';
            })
            .catch(err => alert(err.message));
    }
</script>
</html>
