<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <title>알라딘 도서 등록 | 북스캠프 관리자</title>
</head>

<body>
    <!-- Hero 섹션 비우기 -->
    <section layout:fragment="hero" class="hero" style="display: none;">
    </section>

    <!-- 메인 콘텐츠 -->
    <div layout:fragment="content">
        <section class="product spad">
            <div class="container">
                <div class="row">
                    <!-- 관리자 사이드바 -->
                    <div class="col-lg-3">
                        <div class="hero__categories">
                            <div class="hero__categories__all">
                                <i class="fa fa-bars"></i>
                                <span>관리자 메뉴</span>
                            </div>
                            <ul th:replace="~{fragment/admin-sidebar :: sidebar}">
                                <li><a href="#">메뉴</a></li>
                            </ul>
                        </div>
                    </div>

                    <!-- 도서 정보 입력 폼 -->
                    <div class="col-lg-9">
                        <div class="checkout__form">
                            <h4 style="margin-bottom: 30px;">
                                <i class="fa fa-cloud-download" style="margin-right: 10px; color: #0064FF;"></i>
                                알라딘 도서 등록
                            </h4>

                            <form th:action="@{/admin/aladin/books}" method="post">
                                <div class="row">
                                    <!-- 제목 -->
                                    <div class="col-lg-12">
                                        <div class="checkout__input">
                                            <p>제목<span>*</span></p>
                                            <input type="text"
                                                   name="title"
                                                   th:value="${aladinBook.title}"
                                                   required>
                                        </div>
                                    </div>

                                    <!-- 기여자 -->
                                    <div class="col-lg-6">
                                        <div class="checkout__input">
                                            <p>기여자<span>*</span></p>
                                            <input type="text"
                                                   name="contributors"
                                                   th:value="${aladinBook.author}"
                                                   required>
                                        </div>
                                    </div>

                                    <!-- 출판사 -->
                                    <div class="col-lg-6">
                                        <div class="checkout__input">
                                            <p>출판사<span>*</span></p>
                                            <input type="text"
                                                   name="publisher"
                                                   th:value="${aladinBook.publisher}"
                                                   required>
                                        </div>
                                    </div>

                                    <!-- 출판일 -->
                                    <div class="col-lg-4">
                                        <div class="checkout__input">
                                            <p>출판일</p>
                                            <input type="text"
                                                   name="publishDate"
                                                   th:value="${aladinBook.publishDate}">
                                        </div>
                                    </div>

                                    <!-- ISBN -->
                                    <div class="col-lg-4">
                                        <div class="checkout__input">
                                            <p>ISBN</p>
                                            <input type="text"
                                                   name="isbn"
                                                   th:value="${aladinBook.isbn13}"
                                                   readonly>
                                        </div>
                                    </div>

                                    <!-- 재고 -->
                                    <div class="col-lg-4">
                                        <div class="checkout__input">
                                            <p>재고<span>*</span></p>
                                            <input type="number"
                                                   name="stock"
                                                   placeholder="재고 수량"
                                                   min="0"
                                                   value="0"
                                                   required>
                                        </div>
                                    </div>

                                    <!-- 정가 -->
                                    <div class="col-lg-6">
                                        <div class="checkout__input">
                                            <p>정가</p>
                                            <input type="number"
                                                   name="regularPrice"
                                                   th:value="${aladinBook.regularPrice}"
                                                   min="0">
                                        </div>
                                    </div>

                                    <!-- 판매가 -->
                                    <div class="col-lg-6">
                                        <div class="checkout__input">
                                            <p>판매가</p>
                                            <input type="number"
                                                   name="salePrice"
                                                   th:value="${aladinBook.salePrice}"
                                                   min="0">
                                        </div>
                                    </div>

                                    <!-- 포장 가능 여부 -->
                                    <div class="col-lg-12">
                                        <div class="checkout__input">
                                            <p>포장 가능 여부</p>
                                            <div class="checkout__input__checkbox" style="margin-top: 10px;">
                                                <label for="packable">
                                                    포장 가능
                                                    <input type="checkbox" id="packable" name="packable" value="true">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 이미지 미리보기 -->
                                    <div class="col-lg-12">
                                        <div class="checkout__input">
                                            <p>도서 이미지</p>
                                            <div style="text-align: center; padding: 20px; background: #f8f8f8; border-radius: 4px;">
                                                <img th:src="${aladinBook.cover}"
                                                     alt="도서 표지"
                                                     style="width: 150px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                            </div>
                                            <input type="hidden" name="imgUrls" th:value="${aladinBook.cover}">
                                        </div>
                                    </div>

                                    <!-- 카테고리 -->
                                    <div class="col-lg-6">
                                        <div class="checkout__input">
                                            <p>카테고리<span>*</span></p>
                                            <select name="categoryId" required>
                                                <option value="" disabled selected>카테고리를 선택하세요</option>
                                                <th:block th:each="parent : ${categories}">
                                                    <optgroup th:label="${parent.name}">
                                                        <option th:each="child : ${parent.children}"
                                                                th:value="${child.id}"
                                                                th:text="${child.name}"></option>
                                                    </optgroup>
                                                </th:block>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- 태그 -->
                                    <div class="col-lg-6">
                                        <div class="checkout__input">
                                            <p>태그</p>
                                            <select name="tagIds" multiple size="5">
                                                <option th:each="tag : ${tags}"
                                                        th:value="${tag.id}"
                                                        th:text="${tag.name}"></option>
                                            </select>
                                            <small style="color: #6f6f6f; font-size: 13px; display: block; margin-top: 5px;">
                                                Ctrl(또는 Cmd) 키를 누른 채로 여러 개 선택 가능
                                            </small>
                                        </div>
                                    </div>

                                    <!-- 목차 -->
                                    <div class="col-lg-12">
                                        <div class="checkout__input">
                                            <p>목차</p>
                                            <textarea name="content"
                                                      rows="5"
                                                      th:text="${aladinBook.content}"></textarea>
                                        </div>
                                    </div>

                                    <!-- 설명 -->
                                    <div class="col-lg-12">
                                        <div class="checkout__input">
                                            <p>설명</p>
                                            <textarea name="explanation"
                                                      rows="5"
                                                      th:text="${aladinBook.explanation}"></textarea>
                                        </div>
                                    </div>

                                    <!-- 버튼 -->
                                    <div class="col-lg-12 text-center" style="margin-top: 20px;">
                                        <button type="submit"
                                                class="site-btn"
                                                style="width: 200px; margin-right: 10px;">
                                            등록
                                        </button>
                                        <a th:href="@{/admin/aladin/search}"
                                           class="site-btn"
                                           style="width: 200px; background: #6f6f6f; display: inline-block; text-align: center; text-decoration: none;">
                                            취소
                                        </a>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- 추가 JavaScript -->
    <div layout:fragment="extra-js">
        <script>
            $(document).ready(function() {
                // 관리자 사이드바 전용 토글
                $('.admin-category-header').on('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();

                    var menuId = $(this).data('admin-menu');
                    var $submenu = $('#admin-menu-' + menuId);
                    var $toggle = $(this).find('.admin-toggle');

                    // 토글 버튼 active 클래스 추가/제거 (아이콘 회전)
                    $toggle.toggleClass('active');

                    // 하위 메뉴 슬라이드 토글
                    $submenu.slideToggle(300);
                });

                // 초기화: aria 속성 설정
                $('.admin-toggle').attr('role', 'button');
                $('.admin-toggle').attr('aria-expanded', 'false');
                $('.admin-toggle').attr('tabindex', '0');
            });
        </script>
    </div>
</body>
</html>
