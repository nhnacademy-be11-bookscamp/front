<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <meta charset="UTF-8">
    <title>리뷰 작성 | 북스캠프</title>

    <style>
        .review-box {
            background: #fff;
            padding: 25px;
            border: 1px solid #ebebeb;
            border-radius: 6px;
            margin-top: 30px;
        }

        /* ⭐ 별점 스타일 */
        .stars .star {
            font-size: 32px;
            color: #ccc;
            cursor: pointer;
            transition: color 0.2s;
        }

        .stars .star.selected {
            color: #ffcc00;
        }

        .stars .star:hover {
            color: #ffdd55;
        }

        .img-preview {
            max-width: 120px;
            margin-right: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
    </style>
</head>

<body>
<section layout:fragment="content">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 review-box">

                <h4 style="font-weight:700; margin-bottom:25px;">리뷰 작성</h4>

                <!-- 리뷰 작성 form -->
                <form th:action="@{/mypage/reviews}" method="post" enctype="multipart/form-data">

                    <!-- orderItemId hidden -->
                    <input type="hidden" name="orderItemId" th:value="${orderItemId}">

                    <!-- ⭐ 평점 선택 -->
                    <div style="margin-bottom:20px;">
                        <label style="font-weight:600;">평점</label>

                        <div class="rating-container">
                            <div class="stars">
                                <i class="fa fa-star star" data-value="1"></i>
                                <i class="fa fa-star star" data-value="2"></i>
                                <i class="fa fa-star star" data-value="3"></i>
                                <i class="fa fa-star star" data-value="4"></i>
                                <i class="fa fa-star star" data-value="5"></i>
                            </div>
                            <input type="hidden" name="score" id="scoreInput" value="0">
                        </div>
                    </div>

                    <!-- 내용 -->
                    <div style="margin-bottom:20px;">
                        <label style="font-weight:600;">리뷰 내용</label>
                        <textarea name="content"
                                  style="width:100%; height:140px; border:1px solid #ccc; padding:12px; border-radius:4px;"
                                  placeholder="리뷰 내용을 입력해주세요."></textarea>
                    </div>

                    <!-- 이미지 업로드 -->
                    <div style="margin-bottom:20px;">
                        <label style="font-weight:600;">이미지 업로드</label>
                        <input type="file" name="files" multiple class="form-control">
                    </div>

                    <!-- 버튼 -->
                    <button type="submit" class="site-btn" style="width:100%; margin-top:15px;">
                        리뷰 등록하기
                    </button>

                </form>
            </div>
        </div>
    </div>
</section>

<!-- ⭐ 별점 스크립트 -->
<th:block layout:fragment="extra-js">
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const stars = document.querySelectorAll(".star");
            const scoreInput = document.getElementById("scoreInput");

            stars.forEach(star => {
                star.addEventListener("click", function () {
                    const rating = this.getAttribute("data-value");
                    scoreInput.value = rating;

                    stars.forEach(s => {
                        s.classList.remove("selected");
                        if (s.getAttribute("data-value") <= rating) {
                            s.classList.add("selected");
                        }
                    });
                });
            });
        });
    </script>
</th:block>

</body>
</html>
