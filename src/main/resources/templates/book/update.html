<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">

<head>
    <title>도서 수정</title>
    <th:block layout:fragment="extra-css">
        <style>
            .register-form {
                display: grid;
                grid-template-columns: 1fr 2fr;
                gap: 10px 20px;
                max-width: 700px;
                background: #fff;
                padding: 30px;
                border-radius: 12px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }
            label { text-align: right; padding-top: 6px; font-weight: 600; color: #333; }
            input, textarea, select {
                padding: 8px;
                border: 1px solid #ccc;
                border-radius: 6px;
                font-family: inherit;
            }
            button {
                grid-column: span 2;
                padding: 10px;
                border: none;
                border-radius: 6px;
                background: #4A90E2;
                color: white;
                cursor: pointer;
                font-size: 1rem;
                font-weight: 600;
            }
        </style>
    </th:block>
</head>

<body>
<div layout:fragment="content">
    <h1>도서 수정</h1>

    <form th:action="@{'/admin/books/' + ${book.id} + '/update'}"
          method="post"
          enctype="multipart/form-data"
          class="register-form">

        <label>제목</label>
        <input type="text" name="title" th:value="${book.title}" required>

        <label>기여자</label>
        <input type="text" name="contributors" th:value="${book.contributors}">

        <label>출판사</label>
        <input type="text" name="publisher" th:value="${book.publisher}">

        <label>ISBN</label>
        <input type="text" name="isbn" th:value="${book.isbn}" readonly>

        <label>정가</label>
        <input type="number" name="regularPrice" th:value="${book.regularPrice}">

        <label>판매가</label>
        <input type="number" name="salePrice" th:value="${book.salePrice}">

        <label>재고</label>
        <input type="number" name="stock" th:value="${book.stock}">

        <label>포장 가능 여부</label>
        <input type="checkbox" name="packable" th:checked="${book.packable}">

        <label>설명</label>
        <textarea name="explanation" rows="3" th:text="${book.explanation}"></textarea>

        <label>목차</label>
        <textarea name="content" rows="3" th:text="${book.content}"></textarea>

        <label>기존 이미지</label>
        <div th:each="img : ${book.imgUrls}">
            <img th:src="${img}" style="width:100px;border-radius:6px;margin-right:10px;">
            <span>수정 시 기존 이미지는 삭제됩니다.</span>
        </div>

        <label>새 이미지 업로드</label>
        <input type="file" name="newImages" multiple>

        <label>카테고리</label>
        <select name="categoryIds" multiple>
            <option th:each="c : ${categories}"
                    th:value="${c.id}"
                    th:selected="${book.categoryIds.contains(c.id)}"
                    th:text="${c.name}">
            </option>
        </select>

        <label>태그</label>
        <input type="text" name="tagIds" th:value="${#strings.arrayJoin(book.tagIds, ',')}">

        <button type="submit">수정 완료</button>
    </form>
</div>
</body>
</html>
